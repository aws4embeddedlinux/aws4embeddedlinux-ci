<!DOCTYPE html><html class="default" lang="en" data-base="."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>aws4embeddedlinux-cdk-lib</title><meta name="description" content="Documentation for aws4embeddedlinux-cdk-lib"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">aws4embeddedlinux-cdk-lib</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>aws4embeddedlinux-cdk-lib</h1></div><div class="tsd-panel tsd-typography"><a id="aws4embeddedlinux-ci" class="tsd-anchor"></a><h1 class="tsd-anchor-link">aws4embeddedlinux-ci<a href="#aws4embeddedlinux-ci" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This <a href="https://github.com/aws/aws-cdk" target="_blank" class="external">cdk</a> IaC library helps you to deploy AWS cloud infrastructure to allow embedded Linux builds for your project.</p>
<a id="architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture<a href="#architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="media/architecture.svg" alt="architecture overview" title="Architecture"></p>
<a id="api-documentation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">API documentation<a href="#api-documentation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><a href="https://aws4embeddedlinux.github.io/aws4embeddedlinux-ci/" target="_blank" class="external">API documentation</a> generated by <code>npm run doc</code></p>
<a id="setting-up" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Setting Up<a href="#setting-up" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>In order to use this library, you must set up the <a href="https://docs.aws.amazon.com/cdk/v2/guide/getting_started.html" target="_blank" class="external">CDK</a>, including
installing the CDK tool and bootstrapping the account you wish to deploy to. Additionally, you must have <a href="https://nodejs.org/en/" target="_blank" class="external">Node</a> installed.</p>
<div class="tsd-alert tsd-alert-note"><div class="tsd-alert-title"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><use href="assets/icons.svg#icon-alertNote"></use></svg><span>Note</span></div><p>
This library is tested against Node Versions 22. If these version is not available for your system, we recommend
using <a href="https://github.com/nvm-sh/nvm" target="_blank" class="external">NVM</a> to install a compatible version</p>
</div>
<a id="quickstart" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Quickstart<a href="#quickstart" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Use the <a href="https://github.com/aws4embeddedlinux/aws4embeddedlinux-ci-examples" target="_blank" class="external">examples</a> in our examples repo.</p>
<a id="setting-up-a-new-project" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Setting Up A New Project<a href="#setting-up-a-new-project" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ol>
<li>Create a CDK project. More details can be found in the <a href="https://docs.aws.amazon.com/cdk/v2/guide/getting_started.html" target="_blank" class="external">CDK Getting Started Documentation</a>.<pre><code><span class="hl-0">mkdir</span><span class="hl-1"> </span><span class="hl-0">my</span><span class="hl-1">-</span><span class="hl-0">project</span><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-0">my</span><span class="hl-1">-</span><span class="hl-0">project</span><br/><span class="hl-0">cdk</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1"> </span><span class="hl-0">app</span><span class="hl-1"> --</span><span class="hl-0">language</span><span class="hl-1"> </span><span class="hl-0">typescript</span>
</code><button>Copy</button></pre>

</li>
<li>Add the cdk library with <code>npm install aws4embeddedlinux/aws4embeddedlinux-ci</code>.</li>
<li>Create your application using the library. Refer to the <a href="https://aws4embeddedlinux.github.io/aws4embeddedlinux-ci" target="_blank" class="external">API Documentation</a>
and the <a href="github.com/aws4embeddedlinux/aws4embeddedlinux-ci-examples">Examples</a> for more details.</li>
<li>Deploy your application using <code>cdk deploy</code>.</li>
<li>After the application is deployed, the 'Build Image' Pipeline needs to be run. This will create an Ubuntu based container for
building Yocto. This container is used by the other pipelines. If the other pipelines are run before this container is created
and pushed to <a href="https://aws.amazon.com/ecr/" target="_blank" class="external">ECR</a>, they will fail. This Build Image Pipeline will run weekly by default to keep
this container patched.</li>
<li>Now the application pipeline can be run. This will push the contents of the Yocto deploy directory into S3.</li>
</ol>
<a id="viewing-changes" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Viewing Changes<a href="#viewing-changes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>cdk diff</code> command can be used to preview changes before deployment. This will allow the user to review what is being created.</p>
<a id="development-setup" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Development Setup<a href="#development-setup" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>You can use <a href="https://docs.npmjs.com/cli/v10/commands/npm-link" target="_blank" class="external"><code>npm link</code></a> to develop with a local copy of this repo.</p>
<a id="in-this-library-repo" class="tsd-anchor"></a><h3 class="tsd-anchor-link">In this library repo:<a href="#in-this-library-repo" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-2">npm</span><span class="hl-1"> </span><span class="hl-3">install</span>
</code><button type="button">Copy</button></pre>

<a id="in-your-project-folder" class="tsd-anchor"></a><h3 class="tsd-anchor-link">In your-project folder:<a href="#in-your-project-folder" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-2">npm</span><span class="hl-1"> </span><span class="hl-3">install</span><br/><span class="hl-2">npm</span><span class="hl-1"> </span><span class="hl-3">link</span><span class="hl-1"> </span><span class="hl-3">../aws4embeddedlinux-ci</span>
</code><button type="button">Copy</button></pre>

<p>This will link through the system <code>node_modules</code> install. When using a system node install on Linux, this can require sudo access. To avoid this, use
a <a href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm#using-a-node-version-manager-to-install-nodejs-and-npm" target="_blank" class="external">node version manager</a>
or <a href="https://docs.npmjs.com/resolving-eacces-permissions-errors-when-installing-packages-globally" target="_blank" class="external">set a node prefix</a>.</p>
<a id="known-issues" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Known issues<a href="#known-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>Windows is currently not supported.</li>
<li>When using AWS Cloud9 a micro instance type will run out of memory.</li>
<li>Deletion of stacks while a CodePipeline is running can lead to unexpected failures.</li>
</ul>
<a id="security" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Security<a href="#security" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>See <a href="media/SECURITY.md">SECURITY</a> for more information about reporting issues with this project.</p>
<a id="git-credentials-and-build-time-secrets" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Git Credentials and Build Time Secrets<a href="#git-credentials-and-build-time-secrets" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html" target="_blank" class="external">AWS Secrets Manager</a> is the preferred method of adding secrets
to your pipeline. This service provides a structured means of access and avoids the pitfalls of putting secrets in environment variables,
source repos, etc.</p>
<ol>
<li>Create a <em>Secret</em> in Secrets Manager and add your secret value.</li>
<li>Grant access permissions to the CodeBuild pipeline project.</li>
<li>Create a <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_iam.PolicyStatement.html" target="_blank" class="external">Policy Statement</a> which allows <code>secretsmanager:GetSecretValue</code> for your secret.</li>
<li>Add this policy statement to the <code>buildPolicyAdditions</code> props for the <code>EmbeddedLinuxPipelineStack</code>. e.g.</li>
</ol>
<pre><code class="typescript"><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-5">*</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-0">iam</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-3">&quot;aws-cdk-lib/aws-iam&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">pipeline</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-2">EmbeddedLinuxPipelineStack</span><span class="hl-1">(</span><span class="hl-0">app</span><span class="hl-1">, </span><span class="hl-3">&quot;MyPokyPipeline&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">imageRepo:</span><span class="hl-1"> </span><span class="hl-0">buildImageRepo</span><span class="hl-1">.</span><span class="hl-0">repository</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">imageTag:</span><span class="hl-1"> </span><span class="hl-0">ImageKind</span><span class="hl-1">.</span><span class="hl-0">Ubuntu22_04</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">vpc:</span><span class="hl-1"> </span><span class="hl-0">vpc</span><span class="hl-1">.</span><span class="hl-0">vpc</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">buildPolicyAdditions:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">iam</span><span class="hl-1">.</span><span class="hl-0">PolicyStatement</span><span class="hl-1">.</span><span class="hl-2">fromJson</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-0">Effect:</span><span class="hl-1"> </span><span class="hl-3">&quot;Allow&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">Action:</span><span class="hl-1"> </span><span class="hl-3">&quot;secretsmanager:GetSecretValue&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">Resource:</span><br/><span class="hl-1">        </span><span class="hl-3">&quot;arn:aws:secretsmanager:us-west-2:123456789012:secret:my-secret-??????&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>The secret can then be used in the CodeBuild Project by adding it to the BuildSpec. See
the <a href="https://docs.aws.amazon.com/codebuild/latest/userguide/build-spec-ref.html" target="_blank" class="external">CodeBuild Documentation</a> for more details.</p>
<pre><code class="yaml"><span class="hl-7">env</span><span class="hl-1">:</span><br/><span class="hl-1">    </span><span class="hl-7">secrets-manager</span><span class="hl-1">:</span><br/><span class="hl-1">        </span><span class="hl-7">SECRET_VALUE</span><span class="hl-1">: </span><span class="hl-3">&quot;&lt;Secret ARN&gt;&quot;</span>
</code><button type="button">Copy</button></pre>

<a id="cve-checking-with-yocto" class="tsd-anchor"></a><h3 class="tsd-anchor-link">CVE Checking With Yocto<a href="#cve-checking-with-yocto" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>CVE checking is enabled in the reference implementations. Details on this can be found in
the <a href="https://docs.yoctoproject.org/4.0.13/singleindex.html#checking-for-vulnerabilities" target="_blank" class="external">yocto documentation</a>.</p>
<a id="contributing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Contributing<a href="#contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>See <a href="media/CONTRIBUTING.md">CONTRIBUTING</a> for more information.</p>
<a id="license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This library is licensed under the MIT-0 License. See the <a href="media/LICENSE">LICENSE</a> file.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#aws4embeddedlinux-ci"><span>aws4embeddedlinux-<wbr/>ci</span></a><ul><li><a href="#architecture"><span>Architecture</span></a></li><li><a href="#api-documentation"><span>API documentation</span></a></li></ul><a href="#setting-up"><span>Setting <wbr/>Up</span></a><ul><li><a href="#quickstart"><span>Quickstart</span></a></li><li><a href="#setting-up-a-new-project"><span>Setting <wbr/>Up <wbr/>A <wbr/>New <wbr/>Project</span></a></li><li><a href="#viewing-changes"><span>Viewing <wbr/>Changes</span></a></li><li><a href="#development-setup"><span>Development <wbr/>Setup</span></a></li><li><ul><li><a href="#in-this-library-repo"><span>In this library repo:</span></a></li><li><a href="#in-your-project-folder"><span>In your-<wbr/>project folder:</span></a></li></ul></li><li><a href="#known-issues"><span>Known issues</span></a></li><li><a href="#security"><span>Security</span></a></li><li><ul><li><a href="#git-credentials-and-build-time-secrets"><span>Git <wbr/>Credentials and <wbr/>Build <wbr/>Time <wbr/>Secrets</span></a></li><li><a href="#cve-checking-with-yocto"><span>CVE <wbr/>Checking <wbr/>With <wbr/>Yocto</span></a></li></ul></li><li><a href="#contributing"><span>Contributing</span></a></li><li><a href="#license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">aws4embeddedlinux-cdk-lib</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
